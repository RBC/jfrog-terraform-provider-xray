---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "xray_violations_report Resource - terraform-provider-xray"
subcategory: "Reports"
---

# xray_violations_report (Resource)

Creates Xray Violations report. The Violations report provides you with information on security and license violations for each component in the selected scope. Violations information includes information such as type of violation, impacted artifacts, and severity.

## Example Usage

```terraform
# Example: Create a security violations report for repositories
resource "xray_violations_report" "security-report" {
  name = "security-violations-report"
  resources {
    repository {
      name                  = "docker-local"
      include_path_patterns = ["folder1/path/*", "folder2/path*"]
      exclude_path_patterns = ["folder1/path2/*", "folder2/path2*"]
    }
    repository {
      name                  = "libs-release-local"
      include_path_patterns = ["**/*.jar", "**/*.war"]
    }
  }
  filters {
    type             = "security"
    watch_names      = ["security-watch"]
    policy_names     = ["security-policy"]
    component        = "*log4j*"
    artifact         = "*spring*"
    violation_status = "Active"
    severities       = ["Critical", "High"]

    security_filters {
      issue_id         = "XRAY-87343"
      summary_contains = "remote code execution"
      has_remediation  = true
      cvss_score {
        min_score = 7.0
        max_score = 10.0
      }
      published {
        start = "2023-01-01T00:00:00Z"
        end   = "2023-12-31T23:59:59Z"
      }
    }

    updated {
      start = "2023-01-01T00:00:00Z"
      end   = "2023-12-31T23:59:59Z"
    }
  }
}

# Example: Create a license violations report for builds
resource "xray_violations_report" "license-report" {
  name = "license-violations-report"
  resources {
    builds {
      names                     = ["build-1", "build-2"]
      number_of_latest_versions = 5
    }
  }
  filters {
    type             = "license"
    watch_patterns   = ["license-watch-*"]
    policy_names     = ["license-policy"]
    component        = "*commons*"
    artifact         = "*utils*"
    violation_status = "Active"
    severities       = ["High"]

    license_filters {
      unknown         = true
      license_names   = ["GPL-2.0", "AGPL-3.0"]
      license_patterns = ["*GPL*"]
    }

    updated {
      start = "2023-01-01T00:00:00Z"
      end   = "2023-12-31T23:59:59Z"
    }
  }
}

# Example: Create an operational risk violations report for projects
resource "xray_violations_report" "operational-risk-report" {
  name = "operational-risk-violations-report"
  resources {
    projects {
      names                     = ["project-1", "project-2"]
      number_of_latest_versions = 3
    }
  }
  filters {
    type             = "operational_risk"
    watch_names      = ["ops-risk-watch"]
    policy_names     = ["ops-risk-policy"]
    component        = "*node*"
    artifact         = "*web-app*"
    violation_status = "Active"
    severities       = ["Critical", "High", "Medium"]

    updated {
      start = "2023-01-01T00:00:00Z"
      end   = "2023-12-31T23:59:59Z"
    }
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) Name of the report.

### Optional

- `filters` (Block Set) Advanced filters. (see [below for nested schema](#nestedblock--filters))
- `project_key` (String) Project key for assigning this resource to. Must be 2 - 10 lowercase alphanumeric and hyphen characters.
- `resources` (Block Set) The list of resources to include into the report. (see [below for nested schema](#nestedblock--resources))

### Read-Only

- `id` (String) The ID of this resource.
- `report_id` (Number) Report ID

<a id="nestedblock--filters"></a>
### Nested Schema for `filters`

Optional:

- `artifact` (String) Filter by artifact name, you can use (*) at the beginning or end of a substring as a wildcard.
- `component` (String) Filter by component name, you can use (*) at the beginning or end of a substring as a wildcard.
- `license_filters` (Block Set) Licenses Filters. (see [below for nested schema](#nestedblock--filters--license_filters))
- `policy_names` (Set of String) Select Xray policies by name.
- `security_filters` (Block Set) Security Filters. (see [below for nested schema](#nestedblock--filters--security_filters))
- `severities` (Set of String) Risk/Severites levels. Allowed values: 'Low', 'Medium', 'High', 'Critical'.
- `type` (String) Violation type.
- `updated` (Block Set) (see [below for nested schema](#nestedblock--filters--updated))
- `violation_status` (String) Violation status.
- `watch_names` (Set of String) Select Xray watch by names. Only one attribute - 'watch_names' or 'watch_patterns' can be set.
- `watch_patterns` (Set of String) Select Xray watch name by patterns. Only one attribute - 'watch_names' or 'watch_patterns' can be set..

<a id="nestedblock--filters--license_filters"></a>
### Nested Schema for `filters.license_filters`

Optional:

- `license_names` (Set of String) Filter licenses by names.
- `license_patterns` (Set of String) Filter licenses by patterns.
- `unknown` (Boolean) Unknown displays the components that Xray could not discover any licenses for.


<a id="nestedblock--filters--security_filters"></a>
### Nested Schema for `filters.security_filters`

Optional:

- `cve` (String) CVE.
- `cvss_score` (Block Set) CVSS score. (see [below for nested schema](#nestedblock--filters--security_filters--cvss_score))
- `has_remediation` (Boolean) Whether the issue has a fix or not.
- `issue_id` (String) Issue ID.
- `published` (Block Set) (see [below for nested schema](#nestedblock--filters--security_filters--published))
- `summary_contains` (String) Vulnerability Summary.

<a id="nestedblock--filters--security_filters--cvss_score"></a>
### Nested Schema for `filters.security_filters.cvss_score`

Optional:

- `max_score` (Number) Maximum CVSS score.
- `min_score` (Number) Minimum CVSS score.


<a id="nestedblock--filters--security_filters--published"></a>
### Nested Schema for `filters.security_filters.published`

Optional:

- `end` (String) Published to date.
- `start` (String) Published from date.



<a id="nestedblock--filters--updated"></a>
### Nested Schema for `filters.updated`

Optional:

- `end` (String) Created to date.
- `start` (String) Created from date.



<a id="nestedblock--resources"></a>
### Nested Schema for `resources`

Optional:

- `builds` (Block Set) The builds to include into the report. Only one type of resource can be set per report. (see [below for nested schema](#nestedblock--resources--builds))
- `projects` (Block Set) The projects to include into the report. Only one type of resource can be set per report. (see [below for nested schema](#nestedblock--resources--projects))
- `release_bundles` (Block Set) The release bundles to include into the report. Only one type of resource can be set per report. (see [below for nested schema](#nestedblock--resources--release_bundles))
- `release_bundles_v2` (Block Set) The release bundles v2 to include into the report. Only one type of resource can be set per report. (see [below for nested schema](#nestedblock--resources--release_bundles_v2))
- `repository` (Block Set) The list of repositories for the report. Only one type of resource can be set per report. (see [below for nested schema](#nestedblock--resources--repository))

<a id="nestedblock--resources--builds"></a>
### Nested Schema for `resources.builds`

Optional:

- `exclude_patterns` (Set of String) The list of exclude patterns. Only one of 'names' or '*_patterns' can be set.
- `include_patterns` (Set of String) The list of include patterns. Only one of 'names' or '*_patterns' can be set.
- `names` (Set of String) The list of build names. Only one of 'names' or '*_patterns' can be set.
- `number_of_latest_versions` (Number) The number of latest build versions to include to the report.


<a id="nestedblock--resources--projects"></a>
### Nested Schema for `resources.projects`

Optional:

- `exclude_key_patterns` (Set of String) The list of exclude patterns
- `include_key_patterns` (Set of String) The list of include patterns
- `names` (Set of String) The list of project names.
- `number_of_latest_versions` (Number) The number of latest release bundle versions to include to the report.


<a id="nestedblock--resources--release_bundles"></a>
### Nested Schema for `resources.release_bundles`

Optional:

- `exclude_patterns` (Set of String) The list of exclude patterns
- `include_patterns` (Set of String) The list of include patterns
- `names` (Set of String) The list of release bundles names.
- `number_of_latest_versions` (Number) The number of latest release bundle versions to include to the report.


<a id="nestedblock--resources--release_bundles_v2"></a>
### Nested Schema for `resources.release_bundles_v2`

Optional:

- `exclude_patterns` (Set of String) The list of exclude patterns
- `include_patterns` (Set of String) The list of include patterns
- `names` (Set of String) The list of release bundles names.
- `number_of_latest_versions` (Number) The number of latest release bundle versions to include to the report.


<a id="nestedblock--resources--repository"></a>
### Nested Schema for `resources.repository`

Required:

- `name` (String) Repository name.

Optional:

- `exclude_path_patterns` (Set of String) Exclude path patterns.
- `include_path_patterns` (Set of String) Include path patterns.
