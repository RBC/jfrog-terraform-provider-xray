---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "xray_vulnerabilities_report Resource - terraform-provider-xray"
subcategory: "Reports"
---

# xray_vulnerabilities_report (Resource)

Creates Xray Vulnerabilities report. The Vulnerabilities report provides information about vulnerabilities in your artifacts, builds, and release bundles. In addition to the information provided in the JFrog Platform on each of these entities, the report gives you a wider range of information such as vulnerabilities in multiple repositories, builds and release bundles. Criteria such as vulnerable component, CVE, cvss score, and severity are available in the report.

## Example Usage

```terraform
# Example: Create a vulnerabilities report for repositories with CVE
resource "xray_vulnerabilities_report" "repository-report" {
  name = "repository-vulnerabilities-report"

  # Automated report generation (requires Xray 3.130.0 or higher)
  cron_schedule          = "30 09 * * MON"
  cron_schedule_timezone = "America/New_York"
  emails                 = ["security-team@example.com", "devops@example.com"]
  resources {
    repository {
      name                  = "docker-local"
      include_path_patterns = ["folder1/path/*", "folder2/path*"]
      exclude_path_patterns = ["folder1/path2/*", "folder2/path2*"]
    }
    repository {
      name                  = "libs-release-local"
      include_path_patterns = ["**/*.jar", "**/*.war"]
    }
  }
  filters {
    vulnerable_component = "*log4j*"
    impacted_artifact   = "*spring*"
    has_remediation     = true
    cve                = "CVE-2021-44228"
    cvss_score {
      min_score = 7.0
      max_score = 10.0
    }
    published {
      start = "2023-01-01T00:00:00Z"
      end   = "2023-12-31T23:59:59Z"
    }
    scan_date {
      start = "2023-01-01T00:00:00Z"
      end   = "2023-12-31T23:59:59Z"
    }

    # Contextual Analysis Filter (requires Xray 3.130.0 or higher)
    ca_filter {
      allowed_ca_statuses = [
        "applicable",
        "not_applicable",
        "undetermined",
        "not_scanned"
      ]
    }

    # Runtime Filter (requires Xray 3.130.0 or higher)
    runtime_filter {
      time_period = "7 days"
    }
  }
}

# Example: Create a vulnerabilities report for builds with patterns
resource "xray_vulnerabilities_report" "build-report" {
  name = "build-vulnerabilities-report"

  # Automated report generation (requires Xray 3.130.0 or higher)
  cron_schedule          = "00 23 * * SUN"
  cron_schedule_timezone = "Europe/London"
  emails                 = ["build-team@example.com", "ci-cd@example.com"]
  resources {
    builds {
      include_patterns         = ["build-*", "release-*"]
      exclude_patterns         = ["test-*", "dev-*"]
      number_of_latest_versions = 5
    }
  }
  filters {
    vulnerable_component = "*node*"
    impacted_artifact   = "*web-app*"
    has_remediation     = false
    issue_id           = "XRAY-87343"
    severities         = ["High", "Medium"]
    published {
      start = "2023-01-01T00:00:00Z"
      end   = "2023-12-31T23:59:59Z"
    }
    scan_date {
      start = "2023-01-01T00:00:00Z"
      end   = "2023-12-31T23:59:59Z"
    }

    # Contextual Analysis Filter (requires Xray 3.130.0 or higher)
    ca_filter {
      allowed_ca_statuses = [
        "applicable",
        "not_applicable",
        "undetermined",
        "not_scanned"
      ]
    }

    # Runtime Filter (requires Xray 3.130.0 or higher)
    runtime_filter {
      time_period = "7 days"
    }
  }
}

# Example: Create a vulnerabilities report for projects
resource "xray_vulnerabilities_report" "project-report" {
  name = "project-vulnerabilities-report"

  # Automated report generation (requires Xray 3.130.0 or higher)
  cron_schedule          = "15 06 * * *"
  cron_schedule_timezone = "Asia/Tokyo"
  emails                 = ["project-team@example.com", "managers@example.com"]
  resources {
    projects {
      keys = ["project-1", "project-2"]
      number_of_latest_versions = 3
    }
  }
  filters {
    vulnerable_component = "*commons*"
    impacted_artifact   = "*utils*"
    has_remediation     = true
    severities         = ["Critical", "High", "Medium"]
    published {
      start = "2023-01-01T00:00:00Z"
      end   = "2023-12-31T23:59:59Z"
    }
    scan_date {
      start = "2023-01-01T00:00:00Z"
      end   = "2023-12-31T23:59:59Z"
    }

    # Contextual Analysis Filter (requires Xray 3.130.0 or higher)
    ca_filter {
      allowed_ca_statuses = [
        "applicable",
        "not_applicable",
        "undetermined",
        "not_scanned"
      ]
    }

    # Runtime Filter (requires Xray 3.130.0 or higher)
    runtime_filter {
      time_period = "7 days"
    }
  }
}

# Example: Create a vulnerabilities report for release bundles
resource "xray_vulnerabilities_report" "release-bundle-report" {
  name = "release-bundle-vulnerabilities-report"

  # Automated report generation (requires Xray 3.130.0 or higher)
  cron_schedule          = "45 12 * * FRI"
  cron_schedule_timezone = "UTC"
  emails                 = ["release-team@example.com", "qa@example.com"]
  resources {
    release_bundles {
      names                     = ["release-1", "release-2"]
      number_of_latest_versions = 3
    }
  }
  filters {
    vulnerable_component = "*maven*"
    impacted_artifact   = "*core*"
    has_remediation     = true
    cvss_score {
      min_score = 8.0
      max_score = 10.0
    }
    published {
      start = "2023-01-01T00:00:00Z"
      end   = "2023-12-31T23:59:59Z"
    }
    scan_date {
      start = "2023-01-01T00:00:00Z"
      end   = "2023-12-31T23:59:59Z"
    }

    # Contextual Analysis Filter (requires Xray 3.130.0 or higher)
    ca_filter {
      allowed_ca_statuses = [
        "applicable",
        "not_applicable",
        "undetermined",
        "not_scanned"
      ]
    }

    # Runtime Filter (requires Xray 3.130.0 or higher)
    runtime_filter {
      time_period = "7 days"
    }
  }
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `name` (String) Name of the report.

### Optional

- `cron_schedule` (String) Schedule for automated report generation. Format: 'minute hour day-of-month month day-of-week' where:
  - minute: must be 00, 15, 30, or 45 (quarter-hourly)
  - hour: must be 00-23 (2-digit format, e.g., 03 not 3)
  - day-of-month: 1-31, * (any), or ? (unspecified)
  - month: 1-12 or JAN-DEC
  - day-of-week: 0-6 (0=Sunday) or SUN-SAT
Examples:
  - '45 03 * * MON' = Every Monday at 03:45 AM
  - '00 00 1 * ?' = At midnight (00:00) on the first day of every month
  - '30 12 ? * MON-FRI' = At 12:30 PM every weekday
Note: Requires Xray 3.130.0 or higher.
- `cron_schedule_timezone` (String) Timezone for cron schedule. For valid timezone formats, see: [iana-timezones](https://timeapi.io/documentation/iana-timezones). Note: Requires Xray 3.130.0 or higher. Only used when cron_schedule is set.
- `emails` (Set of String) List of email addresses to notify when report generation is complete. Note: Requires Xray 3.130.0 or higher.
- `filters` (Block Set) Advanced filters. (see [below for nested schema](#nestedblock--filters))
- `project_key` (String) Project key for assigning this resource to. Must be 2 - 10 lowercase alphanumeric and hyphen characters.
- `resources` (Block Set) The list of resources to include into the report. (see [below for nested schema](#nestedblock--resources))

### Read-Only

- `id` (String) The ID of this resource.
- `report_id` (Number) Report ID

<a id="nestedblock--filters"></a>
### Nested Schema for `filters`

Optional:

- `ca_filter` (Block Set) Contextual Analysis Filter. Note: Requires Xray 3.130.0 or higher. (see [below for nested schema](#nestedblock--filters--ca_filter))
- `cve` (String) CVE.
- `cvss_score` (Block Set) CVSS score. (see [below for nested schema](#nestedblock--filters--cvss_score))
- `has_remediation` (Boolean) Whether the issue has a fix or not.
- `impacted_artifact` (String) Filter by artifact name, you can use (*) at the beginning or end of a substring as a wildcard.
- `issue_id` (String) Issue ID.
- `published` (Block Set) (see [below for nested schema](#nestedblock--filters--published))
- `runtime_filter` (Block Set) Runtime Filter. Note: Requires Xray 3.130.0 or higher. (see [below for nested schema](#nestedblock--filters--runtime_filter))
- `scan_date` (Block Set) (see [below for nested schema](#nestedblock--filters--scan_date))
- `severities` (Set of String) Severity levels. Allowed values: 'Low', 'Medium', 'High', 'Critical'
- `vulnerable_component` (String) Filter by component name, you can use (*) at the beginning or end of a substring as a wildcard.

<a id="nestedblock--filters--ca_filter"></a>
### Nested Schema for `filters.ca_filter`

Optional:

- `allowed_ca_statuses` (Set of String) Allowed CA statuses.


<a id="nestedblock--filters--cvss_score"></a>
### Nested Schema for `filters.cvss_score`

Optional:

- `max_score` (Number) Maximum CVSS score.
- `min_score` (Number) Minimum CVSS score.


<a id="nestedblock--filters--published"></a>
### Nested Schema for `filters.published`

Optional:

- `end` (String) Published to date.
- `start` (String) Published from date.


<a id="nestedblock--filters--runtime_filter"></a>
### Nested Schema for `filters.runtime_filter`

Optional:

- `time_period` (String) Time period to filter by.


<a id="nestedblock--filters--scan_date"></a>
### Nested Schema for `filters.scan_date`

Optional:

- `end` (String) Scanned to date.
- `start` (String) Scanned from date.



<a id="nestedblock--resources"></a>
### Nested Schema for `resources`

Optional:

- `builds` (Block Set) The builds to include into the report. Only one type of resource can be set per report. (see [below for nested schema](#nestedblock--resources--builds))
- `projects` (Block Set) The projects to include into the report. Only one type of resource can be set per report. (see [below for nested schema](#nestedblock--resources--projects))
- `release_bundles` (Block Set) The release bundles to include into the report. Only one type of resource can be set per report. (see [below for nested schema](#nestedblock--resources--release_bundles))
- `release_bundles_v2` (Block Set) The release bundles v2 to include into the report. Only one type of resource can be set per report. (see [below for nested schema](#nestedblock--resources--release_bundles_v2))
- `repository` (Block Set) The list of repositories for the report. Only one type of resource can be set per report. (see [below for nested schema](#nestedblock--resources--repository))

<a id="nestedblock--resources--builds"></a>
### Nested Schema for `resources.builds`

Optional:

- `exclude_patterns` (Set of String) The list of exclude patterns. Only one of 'names' or '*_patterns' can be set.
- `include_patterns` (Set of String) The list of include patterns. Only one of 'names' or '*_patterns' can be set.
- `names` (Set of String) The list of build names. Only one of 'names' or '*_patterns' can be set.
- `number_of_latest_versions` (Number) The number of latest build versions to include to the report.


<a id="nestedblock--resources--projects"></a>
### Nested Schema for `resources.projects`

Optional:

- `exclude_key_patterns` (Set of String) The list of exclude patterns
- `include_key_patterns` (Set of String) The list of include patterns
- `keys` (Set of String) The list of project keys. Note: Available from Xray version 3.130.0 and higher.
- `names` (Set of String, Deprecated) The list of project names.
- `number_of_latest_versions` (Number) The number of latest release bundle versions to include to the report.


<a id="nestedblock--resources--release_bundles"></a>
### Nested Schema for `resources.release_bundles`

Optional:

- `exclude_patterns` (Set of String) The list of exclude patterns
- `include_patterns` (Set of String) The list of include patterns
- `names` (Set of String) The list of release bundles names.
- `number_of_latest_versions` (Number) The number of latest release bundle versions to include to the report.


<a id="nestedblock--resources--release_bundles_v2"></a>
### Nested Schema for `resources.release_bundles_v2`

Optional:

- `exclude_patterns` (Set of String) The list of exclude patterns
- `include_patterns` (Set of String) The list of include patterns
- `names` (Set of String) The list of release bundles names.
- `number_of_latest_versions` (Number) The number of latest release bundle versions to include to the report.


<a id="nestedblock--resources--repository"></a>
### Nested Schema for `resources.repository`

Required:

- `name` (String) Repository name.

Optional:

- `exclude_path_patterns` (Set of String) Exclude path patterns.
- `include_path_patterns` (Set of String) Include path patterns.
